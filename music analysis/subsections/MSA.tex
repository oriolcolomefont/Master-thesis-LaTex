\chapter{Music Structure Analysis (MSA)}

MSA encompasses various aspects of music analysis, including algorithms, current practices, and trends in technology. This field aims to comprehensively understand music structure by applying musicological theories, principles, and signal processing algorithms. MSA considers the interplay between technical and musical aspects, focusing on improving our understanding of music signals and the music itself.

In the following section, we will examine the state of MSA, including its challenges and potential for future advancements. Topics such as data representation, computational complexity, and evaluation metrics will be discussed to provide a nuanced summary of the field. Additionally, we will consider the impact of new trends and technological advancements on MSA and the directions in which the field is likely to evolve. Through this examination, we aim to provide an overview of MSA's technical and musical aspects and its challenges.

\section{Concept definition}

Musical structure and form refer to the organization and arrangement of musical elements in a piece of music. They describe how the music is put together and how it unfolds over time.

Musical structure hierarchically arranges various elements of music, such as melody, harmony, rhythm, timbre, and texture\footnote{Musical texture refers to the arrangement and combination of musical elements, including melody, harmony, rhythm, timbre, and dynamics, in a piece of music. Different textures, such as monophonic, homophonic, polyphonic, and heterophonic, can affect a piece's overall character and mood. Understanding musical texture is vital for music analysis and appreciation.}. This hierarchy can take different forms, such as melody being the most critical element, harmony playing a supportive role, or rhythm being the driving force behind the music. The structure of a piece of music is often characterized by its elements' repetition, development, and variation.

Music form, however, refers to the larger-scale organization of musical structure over time. It describes how music sections are repeated, varied, and put together to create a complete piece. Music form can be thought of as the plan or design that underlies a piece of music. Many forms are used in music, such as binary, ternary, rondo, sonata, and theme and variations.

Musicologists and theorists have developed various analytical tools and methods for understanding musical structure and form, including Schenkerian analysis, set theory, and formal function analysis. These tools and methods help uncover the underlying musical relationships and patterns in a piece of music and provide a framework for understanding how it is put together and how it develops over time.

\section{The music structure analysis problem}

Audio-based Music Structural Analysis (MSA) identifies adjacent and non-overlapping musical segments in an audio signal and labels them based on similarity. Segments can occur at various time scales, from short motives to longer sections. Flat MSA focuses on non-hierarchical structures, while hierarchical MSA considers multiple time scales. However, MSA faces challenges such as boundary placement ambiguity and similarity quantification. Segments must be non-overlapping for a given hierarchical level, although some musicological approaches allow for overlap.

\subsection{Problem definition}

MSA challenges its definition due to subjectivity, ambiguity\footnote{Perception and interpretation of musical structure can vary widely between individuals and depend on factors such as personal background, cultural context, and individual preferences. This is due to the complex interplay between individual differences in perception and interpretation and how the auditory system processes sound. These factors highlight the importance of considering individual and cultural context in analyzing and interpreting musical structure.}, and data scarcity. A flat structural analysis of an audio signal consists of a set of contiguous, non-overlapping, and labeled time intervals that span the entire duration of the audio signal. Given a musical recording of T audio samples, a flat segmentation is defined by a set of segment boundaries B, a set of k unique labels Y, and a mapping of segment starting points to labels S. This leads to the label assignment L, which assigns a label to each time point. The segment boundaries are usually sampled at a rate of 10 Hz to achieve a balance between resolution and computational efficiency.

As an art form, music is open to interpretation and can evoke different emotions and meanings in different listeners. This subjectivity makes it difficult to objectively analyze the structure of a piece of music, as different annotators may place boundaries between segments differently based on their perception and interpretation of the music. It can also have multiple structures, including hierarchical structures, that make it difficult to untangle the underlying structure.

\subsection{Segmentation principles}
The main principles of musical structure analysis (MSA) were initially defined as homogeneity, novelty, and repetition, with the addition of regularity later on. 

\subsubsection{Homogeneity and novelty}
Homogeneity assumes that segments are homogeneous in musical attributes, with boundaries between distinct segments being points of novelty. 

\subsubsection{Repetition}
Repetition assumes that segments with the same label are similar sequences, with boundaries defined by repeated sequences' start and endpoints. The structure of the music is represented using a self-similarity matrix to make its structure visually apparent. Homogeneous blocks may be challenging to subdivide, while repeated sequences appear as paths in the self-similarity matrix. MSA approaches focus on identifying these repeated sequences.

\subsubsection{Regularity}
The regularity principle in music structure analysis aims to exploit the regularities present in musical segments, such as the log-normally distributed length across the track and the tendency for the duration of two equally labeled segments to span an integer ratio of beats.

\section{Common methods}

To analyze the structure of a musical recording, a self-similarity matrix (SSM) is often used to visualize the degree of similarity between audio frames. The SSM results in a square matrix with the highest degree of similarity on the diagonal.

It can be computed by representing the audio signal as a spectrogram (or any other suitable representation such as CQT or a Mel-spectrogram) and then calculating the similarity between all pairs of time frames in the spectrogram.

One common approach is to use a dot product, where the similarity between two-time frames is equal to the dot product of their vectors. The dot product of two vectors x and y is given by:

\input{music analysis/Equations/SSM equation}

The resulting matrix will be symmetric, with the diagonal elements representing the similarity between a time frame and itself and the off-diagonal elements representing the similarity between two different time frames.

It's also common to normalize the similarity values by dividing each entry by the Euclidean norm of the compared vectors to ensure that the self-similarity matrix has values between -1 and 1.

Given a self-similarity matrix S, the novelty curve can be computed by taking the row-wise sum of the self-similarity matrix and normalizing the values. The novelty curve measures the deviation from the average similarity across time frames.

\input{music analysis/Equations/Novelty equation}

This representation is used for various tasks, such as identifying repeating patterns in the audio, detecting structural changes in the audio, or for music classification.

The method of computing a novelty curve from a self-similarity matrix is widely used in Music Information Retrieval and audio analysis to assess the deviation from the average similarity of a given time frame in a music signal. It is primarily driven by Digital Signal Processing (DSP) and not necessarily motivated by musical considerations, yet it can be valuable in music segmentation, beat tracking, and structural analysis. However, the approach may be vulnerable to the choice of self-similarity measure used to calculate the matrix, and it may require further domain-specific knowledge and interpretation to extract practical information. Besides, the novelty curve could be limited in its ability to reflect musically meaningful events as it measures the deviation from the average similarity across time frames, rather than following musically motivated criteria. Therefore, the analysis and interpretation of the novelty curve may require additional caution to ensure its efficacy in capturing useful information about the music signal.

\section{Musicological approach}
\section{Topic overview}

MSA has a long history, dating back to music theory and composition studies. In the 18th and 19th centuries, music theorists such as Rameau and Schenker developed analytical frameworks for understanding the structure of music in terms of harmony, melody, and form.

\subsection{Heinrich Schenker}

Heinrich Schenker was a prominent music theorist who developed \textit{Schenkerian Analysis}, a method for analyzing tonal music. This method is based on the concept of "the Ursatz," a fundamental structure of three levels: foreground, middle-ground, and background. Schenker's approach emphasizes the horizontal dimension of music, specifically melody, and the relationships between individual notes and the piece's overall structure. His ideas have significantly impacted the field of music theory and analysis, and the method is still widely used today. While the approach is primarily theoretical and relies on human interpretation, it can also be approached through computer algorithms such as CNNs; the results are not the same as human interpretation.

The fundamental structure, also known as \textit{Ursatz}, represents the underlying structure of a tonal work at the most remote or background level, in the most abstract form. It comprises an essential elaboration of the tonic triad, including the entire line and accompanying bass arpeggiation. The fundamental structure, like the fundamental line, takes one of three forms, depending on which pitch of the tonic triad serves as the primary tone. For example, the key of C major would represent the fundamental structure by the fundamental descending line from scale degree 3.

The \textit{Urlinie}, or fundamental line, unfolds the basic triad and presents tonality on horizontal paths. The tonal system also flows into this to bring a sense of purposeful order to chords by selecting harmonic degrees. Voice leading serves as the mediator between the horizontal formulation of tonality presented by the Urlinie and the vertical formulation presented by the harmonic degrees.

The upper voice of the fundamental structure, represented by the whole line, utilizes a descending direction. In contrast, the lower voice, the bass arpeggiation through the fifth, takes an ascending direction (as shown in figure 1). The combination of the fundamental line and bass arpeggiation constitutes a unity, and neither can exist alone; it is only through their unification in a contrapuntal structure that they produce art.

\subsection{Schenkerian analysis}

Schenkerian analysis is a musical analysis method that examines tonal music using the theories of Heinrich Schenker. The purpose is to showcase the organic unity of a piece by highlighting the relationship between the foreground (all musical notes in the score) and the deep abstract structure known as the \textit{Ursatz}. The Ursatz, roughly the same for all tonal music, is then developed into a unique foreground in each work. The concept of tonal space, defined as the intervals between the notes of the tonic triad in the background, is crucial to the analysis. The tonal space is filled with passing and neighbor tones, creating new triads and tonal spaces for further elaboration.

Schenkerian analysis uses specialized musical notation and is either presented in a generative manner, starting from the Ursatz and ending at the score, or in a reductive manner, starting from the score and reducing it to its fundamental structure. The Ursatz is presented in an arrhythmic graph, and rhythmic signs display hierarchical relationships between events. \footnote{In Schenkerian analysis, structural levels refer to the representation of a piece of music at different levels of abstraction. These levels typically include the foreground, middle ground, and background. Schenker posits that musical form, as represented through these structural levels, can be understood as an energy transformation, specifically the transformation of forces that flow from the background to the foreground through the various levels.}

While complex and challenging, Schenkerian analysis is designed to reveal the internal coherence of a work, which ultimately lies in its tonality. The analysis's results may reflect the analyst's perceptions and intuitions.

\subsection{Aural skills}

The capacity to comprehend and analyze musical compositions through listening requires a range of abilities. These include recognizing musical elements such as rhythm, melody, harmony, timbre, and form, performing music from memory, and transcribing audio recordings into written musical scores.

Having a keen sense of hearing is crucial for a complete understanding of music. It enables musicians to make informed decisions about their playing and interpretation, as well as critically evaluate the playing of others. Aural abilities are essential in music education, deepening appreciation of music and promoting creativity and expression.

Developing these skills can be achieved through various activities, such as attentive listening, singing, playing instruments, and analyzing music through written or visual means. Formal music education includes ear training, dictation, and sight-reading exercises.

Strong aural abilities facilitate personal musical growth and understanding of the underlying musical structure of a piece. Identifying and analyzing musical elements through listening allows comprehension of their relationships and contribution to the overall musical structure. This is fundamental to making informed decisions and interpretations.

Solid listening skills enable effective communication and collaboration among musicians. They provide a common ground for musical discussion, creating and performing music at a higher level.

The ability to perceive and understand musical structure is also essential for preserving musical traditions by accurately passing down the musical heritage of a culture. Recognizing and understanding the underlying musical structures of traditional music maintains its authenticity and ensures its continuation for future generations.

In conclusion, the ability to comprehend and analyze musical compositions through listening is vital for personal musical growth, understanding the musical structure, effective communication, collaboration, and preserving musical traditions.